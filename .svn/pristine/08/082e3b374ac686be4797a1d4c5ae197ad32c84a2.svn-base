<?php
/**
 * æ´»åŠ¨ä¸­å¿ƒ
 * User: éœæ–‡ä¿Š
 * Date: 2019/1/22
 * Time: 14:04
 */

namespace app\car\controller;


use think\Request;
use \app\car\model\Activity as ActivityM;

class Activity extends Controller
{
    private $obj;
    private $type;

    public function __construct(Request $request = null)
    {
        parent::__construct($request);
        $this->obj = new ActivityM();
        $this->type = config('activity_type');
    }

    /**
     * æŸ¥çœ‹ç”¨æˆ·æ´»åŠ¨æ˜ç»†
     * @return array
     */
    public function listA()
    {
        $data = array();
        if (request()->isPost()) {
            $post = request()->post();
            if (!cache($post['token'])) {
                return $this->renderError('ç™»å½•è¿‡æœŸæˆ–å·²å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•');
            }//éªŒè¯token
            $where['u_id'] = cache($post['token']);//ç”¨æˆ·id
            //å½“å‰é¡µ
            $data['now_page'] = isset($post['now_page']) ? $post['now_page'] : 1;
            //æ€»é¡µç 
            $data['sum_page'] = ceil(($this->obj->where(['u_id' => $where['u_id']])->count()) / PAGE);
            //è·å–ç”¨æˆ·æ´»åŠ¨æ˜ç»†
            $data['res'] = $this->obj->allList(PAGE, $data['now_page'], $where);
            return $this->renderSuccess('æ´»åŠ¨ä¸­å¿ƒ', $data);
        }
    }

    /**
     * å¢åŠ ç”¨æˆ·æ´»åŠ¨æ˜ç»†
     */
    public function addA()
    {
        //TODOè€ƒè™‘æ¡ä»¶ğŸ¤”
        //  
    }


}